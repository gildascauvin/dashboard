<div class="lead-container d-flex">
  <div class="col-md-3 lead-left-bar" *ngIf="size >= responsiveSize">
    <div class="lead-bar-content">
      <div class="readiness-level">
        <h3 class="readiness-level-title">
          {{ "#Your readiness level" | dgTranslate }}
        </h3>
        <div class="mrv-score">
          <div class="mrv-score-icon"><i class="fa fa-heartbeat"></i></div>
          <div class="mrv-score-number">
            {{ (user.data && user.data.mrv_score) || 0 }}/10
          </div>
          <div class="mrv-score-label">{{ "#Score MRV" | dgTranslate }}</div>
        </div>
        <a class="btn btn-secondary btn-edit-secondary"
           [routerLink]="links.profile">{{ "#Edit information" | dgTranslate }}</a>
      </div>
      <div class="strenght-level">
        <h3 class="strenght-level-title">
          {{ "#Your strenght level" | dgTranslate }}
        </h3>
        <div class="mt-4 mb-4">
          <app-customer-profile-level [user]="user" [resize]=true></app-customer-profile-level>
        </div>
        <a class="btn btn-secondary btn-edit-secondary"
           [routerLink]="links.performance">{{ "#Edit perfomances" | dgTranslate }}</a>
      </div>
    </div>
  </div>
  <div class="col-md-6 lead-body">
    <div class="lead-body-content text-center mt-4" *ngIf="isEmpty">
      <button class="btn btn-primary" (click)="openExerciceManagerModal()">
        <i class="fa fa-plus"></i> {{ "#Create a workout" | dgTranslate }}
      </button>
    </div>
    <div class="lead-body-content" *ngIf="!isEmpty">

      <div class="workout-date mb-4" *ngFor="let _wo of flatWorkouts; first as isFirst;">

        <div class="row">
          <div [ngClass]="[isFirst ? 'col-12 title-group-datepicker' : 'col-12']">
            <div *ngIf="isFirst" [ngClass]="[size <= responsiveSize ? '' : 'float-right']">
              <div class="input-group">
                <input class="form-control calendar" name="dp" (ngModelChange)="onDateSelected($event)" (click)="d.toggle()"
                       [ngModel]="startedAtModel" ngbDatepicker #d="ngbDatepicker" />
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button"><i class="fa fa-calendar"></i></button>
                </div>
              </div>
            </div>

            <h4 class="title-date">{{ _wo.label }}</h4>
          </div>
        </div>
        <ng-container *ngIf="workouts && workouts[_wo.date]">
          <ng-container *ngFor="let workout of workouts[_wo.date]; first as isFirstDay">

            <ng-container *ngIf="computeFatigueManagementData(workout) as fatigueManagementData">
              <div *ngIf="isFirst && isFirstDay && _wo.date !=''" class="fatigue-management-banner {{ fatigueManagementData.color }}-zone">
                <div class="rectangle rectangle--{{ fatigueManagementData.status }}">

                  <ng-container *ngIf="fatigueManagementData.status == 'todo'">
                    <div class="tpc-circle">
                      <div class="c100 p100 red bg-transparent">
                        <div class="circle-content">
                          <img src="assets/img/logo/logo-power.png" srcset="assets/img/logo/logo-power@2x.png 2x,assets/img/logo/logo-power@3x.png 3x" class="logo">
                          <span class="percentage">?/10</span>
                          <div class="text-white sessions">Energy</div>
                        </div>
                        <div class="slice"><div class="bar"></div><div class="fill"></div></div>
                      </div>
                    </div>

                    <div class="descriptions">
                      <div class="title">Hi {{ user.data.firstname }}</div>
                      <div class="title title-separator">,</div>
                      <div class="title">How do you feel today ?</div>
                      <button class="cta text-white" (click)="openStartSessionModal(workout, workout.day, true)">User input</button>
                    </div>
                  </ng-container>

                  <ng-container *ngIf="fatigueManagementData.status == 'in-progress'">
                    <div class="tpc-circle">
                      <div class="c100 p{{ fatigueManagementData.energy }} {{ fatigueManagementData.color }}">
                        <div class="circle-content">
                          <img src="assets/img/logo/logo-power.png" srcset="assets/img/logo/logo-power@2x.png 2x,assets/img/logo/logo-power@3x.png 3x" class="logo">
                          <span class="percentage">{{ fatigueManagementData.energy }}%</span>
                          <div class="text-white sessions">Energy</div>
                        </div>
                        <div class="slice">
                          <div class="bar"></div>
                          <div class="fill"></div>
                        </div>
                      </div>
                    </div>

                    <div class="descriptions descriptions--no-padding">
                      <div class="title">{{ fatigueManagementData.title }}</div>
                      <div class="subtitle">{{ fatigueManagementData.subtitle }}</div>
                    </div>
                  </ng-container>

                  <ng-container *ngIf="fatigueManagementData.status == 'done'">
                    <div class="tpc-optimal-zone clearfix">
                      <div class="optimal-zone--left {{ fatigueManagementData.colorEnergy }}"></div>
                      <div class="optimal-zone">
                        <div class="title">{{ fatigueManagementData.zoneName }}</div>
                        <div class="subtitle">Zone</div>
                      </div>
                      <div class="optimal-zone--right {{ fatigueManagementData.colorRPE }}"></div>
                      <div class="score energy-score {{ fatigueManagementData.colorEnergy }}">
                        <div class="value">{{ fatigueManagementData.energyScore }}/10</div>
                        <div class="subtitle">Energy score</div>
                      </div>
                      <div class="score rpe-score {{ fatigueManagementData.colorRPE }}">
                        <div class="value">{{ fatigueManagementData.rpeScore }}/10</div>
                        <div class="subtitle">RPE</div>
                      </div>
                    </div>
                    <div class="descriptions">
                      <div class="title">Autoregulation tips</div>
                      <div class="subtitle">{{ fatigueManagementData.subtitle }}</div>
                    </div>
                  </ng-container>
                </div>
              </div>
            </ng-container>

            <div class="workout-session">
              <div *ngIf="workout.name" class="workout-session-title">
                {{ workout.name }}
              </div>
              <button *ngIf="checkIsToday(_wo.date)" class="btn btn-primary start-session"
                      (click)="openStartSessionModal(workout, workout.day)">
                {{ "#Start Session" | dgTranslate }}
              </button>
              <ul class="list-group more-padding">
                <li class="list-group-item box-exercice" *ngFor="
                    let exercice of workout.program.exercices;
                    let indexExercice = index
                  ">

                  <app-athlete-movement-list [class]="'dashboard'" [exercice]="exercice" [hideLocalBox]="true"></app-athlete-movement-list>
                </li>
              </ul>
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>
  </div>
  <div class="col-md-3 lead-right-bar" *ngIf="size >= responsiveSize">
    <div class="lead-bar-content lead-bar-content-right">
      <app-customer-stats-range [showRange]="false" [isFromUrl]="isFromUrl"></app-customer-stats-range>
      <app-customer-stats [resize]="true" [showCardio]="false" [isFromUrl]="isFromUrl"></app-customer-stats>
      <hr />
      <app-customer-stats-exercice [isFromUrl]="isFromUrl" [isFromOverView]="true"></app-customer-stats-exercice>
    </div>
  </div>
</div>
